[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "پکیجی برای ذخیره اطلاعات بنیادی و بازاری",
    "section": "",
    "text": "پیش گفتار\nاین بسته توسط محسن ابراهیمی [1] در حال توسعه است. نظرات و پیشنهادات خود را می‌توانید از طریق ایمیل mohsenebrahimy.ir@gmail.com برای بهبود بسته به برنامه نویس ارسال کنید تا در هر بروزرسانی اصلاحات صورت گیرد. این نسخه در تاریخ ۱۴۰۳-۰۳-۲۴ بروزرسانی شده است.\n\n\nتلگرام codal_tsetmc_package\nایتا codal_tsetmc_package\nمستندات\nگیت هاب\n\nامیدوارم این کتاب برایتان مفید باشد.\n\n\n\n\n\n\nهشدار\n\n\n\nاگر این متن را میبینید یعنی این پکیج درحال توسعه و درحالت بتا است و قابلیت استفاده در پروژه‌های مهم را ندارد.\n\n\n\n\n\n\n[1] محسن ابراهیمی, https://mohsenebrahimy.ir",
    "crumbs": [
      "پیش گفتار"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "مقدمه",
    "section": "",
    "text": "برای روش‌های تحلیل‌های بنیادی و ارزشگذاری سهام نیاز به دسترسی سریع به صورت‌های مالی شرکت‌های بورسی است که در سایت کدال [1] گزارش می‌شود. از آنجایی که بسته‌های زیادی در زمینه ذخیره داده‌های سایت بورس تهران [2] وجود دارد، جای خالی بسته‌ای برای تهیه صورت مالی احساس می‌شد. بنابراین در پی تهیه این بسته پایتونی شدم تا قدمی در جهت دسترسی آسان و سریع تر به اطلاعات بورسی بردارم. قطعا هر گونه پیشنهاد و اصلاحات از طرف توسعه دهندگان پذیرفته می‌شود که می‌توانند به صفخه گیت‌هاب [3] پروژه ارسال کنند.\nبرای استفاده از این بسته می‌توانید به صفحه راهنمای [4] بسته مراجع کنید.\n\nمحسن ابراهیمی [5]\n\n\n\n\n\n[1] کدال, “سامانه جامع اطلاع رسانی ناشران.” https://codal.ir/\n\n\n[2] بورس تهران, “شرکت مدیریت فناوری بورس تهران.” http://tsetmc.com/\n\n\n[3] محسن ابراهیمی, “صفحه گیت‌هاب بسته کدال و بورس تهران در پایتون.” https://github.com/mohsenebrahimyir/codal-tsetmc/\n\n\n[4] محسن ابراهیمی, “صفحه راهنمای بسته کدال و بورس تهران در پایتون.” https://mohsenebrahimyir.github.io/codal-tsetmc/\n\n\n[5] محسن ابراهیمی, https://mohsenebrahimy.ir",
    "crumbs": [
      "مقدمه"
    ]
  },
  {
    "objectID": "installation.html",
    "href": "installation.html",
    "title": "نصب",
    "section": "",
    "text": "برای استفاده از این بسته پیشنهاد می‌شود از محیط مجازی استفاده کنید.\npython -m venv .venv\nفعال سازی محیط مجازی در لینوکس\nsource .venv/bin/activate\nفعال سازی محیط مجازی در ویندوز\n.\\venv\\Scripts\\activate\nنصب [1]:\npip install --upgrade codal-tsetmc\nنصب در حال توسعه [2]:\npip install --upgrade git+https://github.com/mohsenebrahimyir/codal-tsetmc.git\n\n\n\n\n[1] محسن ابراهیمی, “صفحه نصب بسته کدال و بورس تهران در پایتون.” https://pypi.org/project/codal-tsetmc/\n\n\n[2] محسن ابراهیمی, “صفحه گیت‌هاب بسته کدال و بورس تهران در پایتون.” https://github.com/mohsenebrahimyir/codal-tsetmc/",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>نصب</span>"
    ]
  },
  {
    "objectID": "guide.html",
    "href": "guide.html",
    "title": "راهنمای بسته",
    "section": "",
    "text": "گرفتن اطلاعات مستقیم\nگرفتن تاریخچه قیمت شاخص\nfrom codal_tsetmc.download.tsetmc.price import get_index_prices_history\n\nget_index_prices_history()",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>راهنمای بسته</span>"
    ]
  },
  {
    "objectID": "guide.html#گرفتن-اطلاعات-مستقیم",
    "href": "guide.html#گرفتن-اطلاعات-مستقیم",
    "title": "راهنمای بسته",
    "section": "",
    "text": "date    price   jdate   code    ticker\n0   2008-12-04  9248.9  1387-09-14  32097828799138957   INDEX\n1   2008-12-05  9248.9  1387-09-15  32097828799138957   INDEX\n2   2008-12-06  9178.3  1387-09-16  32097828799138957   INDEX\n3   2008-12-07  9130.5  1387-09-17  32097828799138957   INDEX\n4   2008-12-08  9089.2  1387-09-18  32097828799138957   INDEX\n... ... ... ... ... ...\n3551    2023-08-23  1946593.9   1402-06-01  32097828799138957   INDEX\n3552    2023-08-26  1993097.2   1402-06-04  32097828799138957   INDEX\n3553    2023-08-27  2051471.9   1402-06-05  32097828799138957   INDEX\n3554    2023-08-28  2084168.4   1402-06-06  32097828799138957   INDEX\n3555    2023-08-29  2095048.9   1402-06-07  32097828799138957   INDEX\n\nگرفتن تایخچه قیمت سهم\n\nsymbol = \"فولاد\"\ncode = \"46348559193224090\"\n\n\nfrom codal_tsetmc.download.tsetmc.price import get_stock_prices_history\n\nget_stock_prices_history(code)\n\ndate    high    low price   close   open    yesterday   value   volume  count   jdate   code\n0   2023-08-29  5730.0  5520.0  5610.0  5530.0  5630.0  5580.0  7.397634e+11    131877599   5665    1402-06-07  46348559193224090\n1   2023-08-28  5690.0  5480.0  5580.0  5550.0  5590.0  5500.0  9.294742e+11    166512551   7310    1402-06-06  46348559193224090\n2   2023-08-27  5580.0  5270.0  5500.0  5520.0  5340.0  5220.0  1.282123e+12    233151626   9017    1402-06-05  46348559193224090\n3   2023-08-26  5310.0  5050.0  5220.0  5260.0  5110.0  5000.0  8.011761e+11    153494477   5931    1402-06-04  46348559193224090\n4   2023-08-23  5050.0  4950.0  5000.0  5040.0  4960.0  5000.0  3.489348e+11    69737133    3823    1402-06-01  46348559193224090\n... ... ... ... ... ... ... ... ... ... ... ... ...\n3630    2007-03-17  1927.0  1896.0  1898.0  1898.0  1896.0  1934.0  2.823901e+10    14877283    1514    1385-12-26  46348559193224090\n3631    2007-03-14  1966.0  1934.0  1934.0  1934.0  1934.0  1973.0  5.166638e+10    26705128    1901    1385-12-23  46348559193224090\n3632    2007-03-13  1976.0  1915.0  1973.0  1973.0  1976.0  1938.0  2.492415e+11    126270939   5862    1385-12-22  46348559193224090\n3633    2007-03-12  1938.0  1938.0  1938.0  1938.0  1938.0  1900.0  1.938795e+11    100041000   9214    1385-12-21  46348559193224090\n3634    2007-03-11  1938.0  1900.0  1900.0  1900.0  1900.0  1900.0  8.894372e+11    468077431   7736    1385-12-20  46348559193224090\n\n\nگرفتن تاریخچه افزایش سرمایه\n\nfrom codal_tsetmc.download.tsetmc.capital import get_stock_capitals_history\n\nget_stock_capitals_history(code)\n\n    date    new old code\n8   13891125000000  2.580000e+10    1.580000e+10    46348559193224090\n7   13920505000000  3.600000e+10    2.580000e+10    46348559193224090\n6   13930515000000  5.000000e+10    3.600000e+10    46348559193224090\n5   13940726000000  7.500000e+10    5.000000e+10    46348559193224090\n4   13971130000000  1.300000e+11    7.500000e+10    46348559193224090\n3   13981022000000  2.090000e+11    1.300000e+11    46348559193224090\n2   14000303000000  2.930000e+11    2.090000e+11    46348559193224090\n1   14010518000000  5.300000e+11    2.930000e+11    46348559193224090\n0   14011228000000  8.000000e+11    5.300000e+11    46348559193224090",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>راهنمای بسته</span>"
    ]
  },
  {
    "objectID": "guide.html#ساختن-دیتابیس",
    "href": "guide.html#ساختن-دیتابیس",
    "title": "راهنمای بسته",
    "section": "ساختن دیتابیس",
    "text": "ساختن دیتابیس\n\n\n\n\n\n\n\n\nG\n\n\n\ncreate_db\n\ncreate_db\n\n\n\ninit_db\n\ninit_db\n\n\n\ncreate_db--init_db\n\n\n\n\nfill_db\n\nfill_db\n\n\n\ninit_db--fill_db\n\n\n\n\n\n\n\nشکل 2.1: ترتیب اجرای کدها برای ایجاد دیتابیس\n\n\n\n\n\n\nایجاد دیتابیس\nبرای ذخیره داده‌های مختلف جدولی در دیتابیس تعبیه شده که در وحله اول باید آنها را ایجاد کنیم\n\nfrom codal_tsetmc import create_db\n\ncreate_db()\n\n\n\nپر کردن بخش اطلاعات کلی\nبرای استفاده از توابع و گرفتن اطلاعات از تمام بازار مانند اطلاعات شرکت‌های لیست شده در کدال و بورس باید دستور زیر اجرا شود.\n\nfrom codal_tsetmc import init_db\n\ninit_db()\n\ndownloading company and stock info from CODAL and TSETMC\nThis may take several minutes\ncreating stock with code 57524237583720590\n...\n...\nstock with code 32097828799138957 exist\n...\n\n\nپر کردن تمام پایگاه داده\nبرای تکمیل یکباره تمام دیتابیس می‌توان از دستور زیر استفاده کرد که به دلیل زمان بر بودن پیشنهاد می‌شود صرفا برای آغاز کار استفاده شود و در ادامه استفاده از پکیج به صورت موردی از توابع دیگر استفاده شود.\n\n\n\n\n\n\nهشدار\n\n\n\nپر کردن تمام دیتابیس کاری زمان بر است و در حالت کلی استفاده از آن پیشنهاد نمی‌شود.\n\n\n\nfrom codal_tsetmc import fill_db\n\nfill_db()\n\ndownloading company and stock details from CODAL and TSETMC\nmay take few minutes\nThis may take several minutes\n...\n...\nPrice Download Finished. \n...\n...\nCapital Download Finished.\nFor more info go to:\nhttps://github.com/mohsenebrahimyir/codal-tsetmc\n\n\nگرفتن اطلاعات از دیتابیس\nگرفتن اطلاعات از دیتابیس با استفاده از SQL QUERY:\n\nfrom codal_tsetmc import read_table_by_sql_query\n\nread_table_by_sql_query(\n    \"\"\"\n    SELECT * FROM companies\n    \"\"\"\n)\n\n\nid  symbol  name    isic    type_code   status_code\n0   1   لازما   کارخانه های صنعتی آزمایش    293002  1   2\n1   2   لاستیک بارز لرستان  لاستیک بارز لرستان  811085  -1  3\n2   3   لاستیک خوزستان  لاستیک خوزستان  811579  -1  3\n3   4   لاستیک سیرجان   مجتمع صنایع لاستیک بارز سیرجان  791199  4   2\n4   5   لاستیک سیرجان شتاب  لاستیک سیرجان شتاب  811765  -1  3\n... ... ... ... ... ... ...\n4902    4903    وپارس حافظ  سرمایه گذاری توسعه مدیریت پارس حافظ 46431080    3   2\n4903    4904    ورشد خواهان سرمایه گذاری رشد خواهان جوان    46431085    3   2\n4904    4905    سپید    سپید ماکیان 014102  1   0\n4905    4906    و پول و سرمایه  سرمایه گذاری همراه پول و سرمایه 46431079    3   2\n4906    4907    خیریه حامیان ایتام مهر امام رضا خیریه حامیان ایتام مهر امام رضا 771074  4   3\n4907 rows × 6 columns",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>راهنمای بسته</span>"
    ]
  },
  {
    "objectID": "codal.html",
    "href": "codal.html",
    "title": "کدال",
    "section": "",
    "text": "گرفتن لینک با تنظیم فیلتر برای جستجوی گزارشات از کدال\nپر کردن جدول شرکت‌های لیست شده در کدال\nfrom codal_tsetmc import fill_companies_table\n\nfill_companies_table()\n\nrelation \"companies\" already exists\nدانلود داده‌های مورد نیاز برای جستجو\nfrom codal_tsetmc import fill_categories_table\n\nfill_categories_table()\n\nrelation \"company_statuses\" already exists",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>کدال</span>"
    ]
  },
  {
    "objectID": "codal.html#گرفتن-لینک-با-تنظیم-فیلتر-برای-جستجوی-گزارشات-از-کدال",
    "href": "codal.html#گرفتن-لینک-با-تنظیم-فیلتر-برای-جستجوی-گزارشات-از-کدال",
    "title": "کدال",
    "section": "",
    "text": "تعریف یک جستجو\nبرای تنظیم یک جستجو یا (query) باید ابتدا یک شی یا (object) از کلاس جستجوی کدال (CodalQuery) ایجاد کنید بعد تنظیمات دلخواه را روی آن اعمال کنید\n\n\nتنظیمات برای جستجو\nتنظیمات موجود در کلاس جستجوی کدال به همراه مقادیر پیشفرض\n\n\n\n\nتصویر فیلتر جستجو در سایت کدال\n\n\n\n#| eval: false\n# وارد کردن یک شی جستجوی کدال\nfrom codal_tsetmc import CodalQuery\n\n# ساختن یک شی از شی جستجوی کدال\nquery = CodalQuery()\n\n#1. تنظیم نام نماد\nquery.set_symbol(symbol: str = \"\")\n\n#2. تنظیم وضعیت ناشر\nquery.set_publisher_status(title: str = \"\")\n\n#3. تنظیم گروع اطلاعیه\nquery.set_category(title: str = \"\")\n\n#4. تنظیم نوع شرکت\nquery.set_company_type(title: str = \"\")\n\n#5. تنظیم نوع اطلاعیه\nquery.set_letter_type(title: str = \"\")\n\n#6. تنظیم موضوع اطلاعیه\nquery.set_subject(subject: str = \"\")\n\n#7. تنظیم شماره پیگیری\nquery.set_tracing_no(no: str = \"\")\n\n#8. تنظیم کد اطلاعیه\nquery.set_letter_code(code: str = \"\")\n\n#9. تنظیم طول دوره\nquery.set_length_period(period=-1)\n\n#10. تنظیم از تاریخ\nquery.set_from_date(date: str = \"1300/01/01\")\n\n#11. تنظیم تا تاریخ\nquery.set_to_date(date: str = \"1500/01/01\")\n\n#12. تنظیم حسابرسی شده\nquery.set_audited(status: bool = True)\n\n#13. تنظیم حسابرسی نشده\nquery.set_not_audited(status: bool = True)\n\n#14. تنظیم اصلی\nquery.set_consolidatable(status: bool = True)\n\n#15. تنظیم تلفیقی\nquery.set_not_consolidatable(status: bool = True)\n\n#16. تنظیم فقط زیرمجموعه ها\nquery.set_childs(status: bool = True)\n\n#17. تنظیم فقط شرکت اصلی\nquery.set_mains(status: bool = True)\n\n#18. تنظیم موسسه حسابرسی شرکت\nquery.set_auditor_ref(name: str = None)\n\n#19. سالی مالی منتهی به\nquery.set_year_end_to_date(date: str = \"1300/01/01\")\n\n#20. تنظیم فقط اطلاعیه های منتشر شده از طرف سازمان\nquery.set_publisher(status: bool = True)\n\n#21. حذف تنظیمات\nquery.remove_none(dictionary)\n\n# تنظیم شماره ISIC\nquery.set_isic(isic: str = \"\")\n\n# تنظیم شماره صفحه\nquery.set_page_number(number: int = 0)\n\n# گرفتن شماره صفحه\nquery.get_page_number()\n\n# نمایش تعداد صفحات جستجو\nquery.page\n\n# گرفتن مواد تنظیم شده برای جستجو\nquery.params\n\n\"\"\"################\nگرفتن لینک کوئری کدال\n################\"\"\"\n\n#22. گرفتن لینک\nquery.get_query_url(api: bool = True)\n\n#22. گرفتن لیست گزارش\nquery.get_report_list_url()\n\n#22. گرفتن کوئری جستوجو\nquery.get_api_search_url()\n\n\"\"\"################\nگرفتن اطلاعات از کدال\n################\"\"\"\n\n# گرفتن اطلاعات کلی در یک صفحه\nquery.get_api_sigle_page()\n\n# گرفتن اطلاعات کلی در همه صفحات\nquery.get_api_multi_page(pages: int = 0)\n\n# گرفتن اطلاعات کلی تمام صفحات به صورت یک فرمت داده\nquery.get_letters(pages: int = 0, show = False)\n\n# نمایش اطلاعات نامه‌ها و صورت‌مالیهای جستجو شده\nquery.letters\n\nگرفتن یک جستجوی خاص برای چند نماد با سرعت بالا و ذخیره آن در دیتابیس\n#| eval: false\nfrom codal_tsetmc.download.codal.letters import *\n\n# گرفتن و ذخیره لیست گزارشات با یک جستجوی مشابه برای لیستی از نمادها و ذخیره در دیتابیس\nupdate_letters_table(\n  query: CodalQuery,\n  symbols: list,\n  msg: str = \"\"\n)\n\n\n\nیک مثال از نحوه استفاده\n\nتنظیم فیلترهای دلخواه\n\n\nfrom codal_tsetmc import CodalQuery\n\nquery = CodalQuery()\n\n\nنام نماد\n\n\nquery.set_symbol(\"وبملت\")\n\n\nاز تاریخ\n\n\nquery.set_from_date(\"1400/01/01\")\n\n\nگروه اطلاعیه\n\n\nquery.set_category('اطلاعات و صورت مالی سالانه')\n\n\nنوع اطلاعیه\n\n\nquery.set_letter_type('اطلاعات و صورتهای مالی میاندوره ای')\n\n\nحذف حسابرسی نشده‌ها یا حذف حسابرسی شده‌ها\n\n\nquery.set_not_audited(False)\n# query.set_audited(False)\n\n\nفقط زیر مجموعه‌ها\n\n\nquery.set_childs(False)\n\n\nنمایش موارد تنظیم شده\n\n\nquery.params\n\n{'PageNumber': 1,\n 'Symbol': 'وبملت',\n 'PublisherStatus': -1,\n 'Category': 1,\n 'CompanyType': -1,\n 'LetterType': 6,\n 'Subject': -1,\n 'TracingNo': -1,\n 'LetterCode': -1,\n 'Lenght': -1,\n 'FromDate': '1400/01/01',\n 'ToDate': -1,\n 'Audited': 'true',\n 'NotAudited': 'false',\n 'Consolidatable': 'true',\n 'NotConsolidatable': 'true',\n 'Childs': 'false',\n 'Mains': 'true',\n 'AuditorRef': -1,\n 'YearEndToDate': -1,\n 'Publisher': 'false'}\n\n\n\nگرفتن لینک برای مرورگر\n\n\nquery.get_report_list_url()\n\n'https://codal.ir/ReportList.aspx?search&PageNumber=1&Symbol=%D9%88%D8%A8%D9%85%D9%84%D8%AA&Category=1&LetterType=6&FromDate=1400%2F01%2F01&Audited=true&NotAudited=false&Consolidatable=true&NotConsolidatable=true&Childs=false&Mains=true&Publisher=false'\n\n\n\nگرفتن لینک برای api\n\n\nquery.get_query_url()\n\n'https://search.codal.ir/api/search/v2/q?&PageNumber=1&Symbol=%D9%88%D8%A8%D9%85%D9%84%D8%AA&Category=1&LetterType=6&FromDate=1400%2F01%2F01&Audited=true&NotAudited=false&Consolidatable=true&NotConsolidatable=true&Childs=false&Mains=true&Publisher=false&search=true'\n\n\n\nگرفتن لیست گزارشات\n\n\nquery.get_api_multi_page()\n\n[{'SuperVision': {'UnderSupervision': 1,\n   'AdditionalInfo': '',\n   'Reasons': ['عدم ارائه صورت\\u200cهای مالی ۱۲ ماهه حسابرسی شدۀ شرکت اصلی و تلفیقی گروه',\n    'عدم ارائه گزارش هیئت\\u200cمدیره به مجمع و اظهارنظر حسابرس در مورد آن',\n    'عدم ارائه گزارش تفسیری مدیریت ۱۲ ماهه حسابرسی شده']},\n  'TracingNo': 1116260,\n  'Symbol': 'وبملت',\n  'CompanyName': 'بانک ملت',\n  'UnderSupervision': 0,\n  'Title': 'اطلاعات و صورت\\u200cهای مالی میاندوره\\u200cای تلفیقی دوره ۶ ماهه منتهی به  ۱۴۰۲/۰۶/۳۱ (حسابرسی شده)',\n  'LetterCode': 'ن-۱۰',\n  'SentDateTime': '۱۴۰۲/۰۹/۱۵ ۲۰:۰۳:۳۵',\n  'PublishDateTime': '۱۴۰۲/۰۹/۱۵ ۲۰:۰۳:۳۵',\n  'HasHtml': True,\n  'IsEstimate': False,\n  'Url': '/Reports/Decision.aspx?LetterSerial=OVLjMIHaAZsXZK6TitYWxQ%3d%3d&rt=3&let=6&ct=0&ft=-1',\n  'HasExcel': True,\n  'HasPdf': True,\n  'HasXbrl': False,\n  'HasAttachment': True,\n  'AttachmentUrl': '/Reports/Attachment.aspx?LetterSerial=OVLjMIHaAZsXZK6TitYWxQ%3d%3d',\n  'PdfUrl': 'DownloadFile.aspx?hs=OVLjMIHaAZsXZK6TitYWxQ%3d%3d&ft=1005&let=6',\n  'ExcelUrl': 'https://excel.codal.ir/service/Excel/GetAll/OVLjMIHaAZsXZK6TitYWxQ%3d%3d/0',\n  'XbrlUrl': '',\n  'TedanUrl': 'http://www.tedan.ir'},\n {'SuperVision': {'UnderSupervision': 1,\n   'AdditionalInfo': '',\n   'Reasons': ['عدم ارائه صورت\\u200cهای مالی ۱۲ ماهه حسابرسی شدۀ شرکت اصلی و تلفیقی گروه',\n    'عدم ارائه گزارش هیئت\\u200cمدیره به مجمع و اظهارنظر حسابرس در مورد آن',\n    'عدم ارائه گزارش تفسیری مدیریت ۱۲ ماهه حسابرسی شده']},\n  'TracingNo': 1041366,\n  'Symbol': 'وبملت',\n  'CompanyName': 'بانک ملت',\n  'UnderSupervision': 0,\n  'Title': 'صورت\\u200cهای مالی تلفیقی سال مالی منتهی به ۱۴۰۱/۱۲/۲۹ (حسابرسی شده)',\n  'LetterCode': 'ن-۱۰',\n  'SentDateTime': '۱۴۰۲/۰۳/۲۸ ۲۰:۲۹:۵۴',\n  'PublishDateTime': '۱۴۰۲/۰۳/۲۸ ۲۰:۲۹:۵۴',\n  'HasHtml': True,\n  'IsEstimate': False,\n  'Url': '/Reports/Decision.aspx?LetterSerial=5mk9zW2T9eTUWjPZUakQQQaQQQ8A%3d%3d&rt=3&let=6&ct=0&ft=-1',\n  'HasExcel': True,\n  'HasPdf': True,\n  'HasXbrl': False,\n  'HasAttachment': True,\n  'AttachmentUrl': '/Reports/Attachment.aspx?LetterSerial=5mk9zW2T9eTUWjPZUakQQQaQQQ8A%3d%3d',\n  'PdfUrl': 'DownloadFile.aspx?hs=5mk9zW2T9eTUWjPZUakQQQaQQQ8A%3d%3d&ft=1005&let=6',\n  'ExcelUrl': 'https://excel.codal.ir/service/Excel/GetAll/5mk9zW2T9eTUWjPZUakQQQaQQQ8A%3d%3d/0',\n  'XbrlUrl': '',\n  'TedanUrl': 'http://www.tedan.ir'},\n {'SuperVision': {'UnderSupervision': 1,\n   'AdditionalInfo': '',\n   'Reasons': ['عدم ارائه صورت\\u200cهای مالی ۱۲ ماهه حسابرسی شدۀ شرکت اصلی و تلفیقی گروه',\n    'عدم ارائه گزارش هیئت\\u200cمدیره به مجمع و اظهارنظر حسابرس در مورد آن',\n    'عدم ارائه گزارش تفسیری مدیریت ۱۲ ماهه حسابرسی شده']},\n  'TracingNo': 966408,\n  'Symbol': 'وبملت',\n  'CompanyName': 'بانک ملت',\n  'UnderSupervision': 0,\n  'Title': 'اطلاعات و صورت\\u200cهای مالی میاندوره\\u200cای تلفیقی دوره ۶ ماهه منتهی به  ۱۴۰۱/۰۶/۳۱ (حسابرسی شده)',\n  'LetterCode': 'ن-۱۰',\n  'SentDateTime': '۱۴۰۱/۰۹/۱۵ ۱۹:۵۶:۵۷',\n  'PublishDateTime': '۱۴۰۱/۰۹/۱۵ ۱۹:۵۶:۵۷',\n  'HasHtml': True,\n  'IsEstimate': False,\n  'Url': '/Reports/Decision.aspx?LetterSerial=OrRG4vaz36UjbkVcznu8fA%3d%3d&rt=3&let=6&ct=0&ft=-1',\n  'HasExcel': True,\n  'HasPdf': True,\n  'HasXbrl': False,\n  'HasAttachment': True,\n  'AttachmentUrl': '/Reports/Attachment.aspx?LetterSerial=OrRG4vaz36UjbkVcznu8fA%3d%3d',\n  'PdfUrl': 'DownloadFile.aspx?hs=OrRG4vaz36UjbkVcznu8fA%3d%3d&ft=1005&let=6',\n  'ExcelUrl': 'https://excel.codal.ir/service/Excel/GetAll/OrRG4vaz36UjbkVcznu8fA%3d%3d/0',\n  'XbrlUrl': '',\n  'TedanUrl': 'http://www.tedan.ir'},\n {'SuperVision': {'UnderSupervision': 1,\n   'AdditionalInfo': '',\n   'Reasons': ['عدم ارائه صورت\\u200cهای مالی ۱۲ ماهه حسابرسی شدۀ شرکت اصلی و تلفیقی گروه',\n    'عدم ارائه گزارش هیئت\\u200cمدیره به مجمع و اظهارنظر حسابرس در مورد آن',\n    'عدم ارائه گزارش تفسیری مدیریت ۱۲ ماهه حسابرسی شده']},\n  'TracingNo': 896865,\n  'Symbol': 'وبملت',\n  'CompanyName': 'بانک ملت',\n  'UnderSupervision': 0,\n  'Title': 'صورت\\u200cهای مالی تلفیقی سال مالی منتهی به ۱۴۰۰/۱۲/۲۹ (حسابرسی شده)',\n  'LetterCode': 'ن-۱۰',\n  'SentDateTime': '۱۴۰۱/۰۳/۲۹ ۰۰:۰۲:۰۱',\n  'PublishDateTime': '۱۴۰۱/۰۳/۲۹ ۰۰:۰۲:۰۱',\n  'HasHtml': True,\n  'IsEstimate': False,\n  'Url': '/Reports/Decision.aspx?LetterSerial=YLhTbKc77KtnbMHocooRSQ%3d%3d&rt=3&let=6&ct=0&ft=-1',\n  'HasExcel': True,\n  'HasPdf': True,\n  'HasXbrl': False,\n  'HasAttachment': True,\n  'AttachmentUrl': '/Reports/Attachment.aspx?LetterSerial=YLhTbKc77KtnbMHocooRSQ%3d%3d',\n  'PdfUrl': 'DownloadFile.aspx?hs=YLhTbKc77KtnbMHocooRSQ%3d%3d&ft=1005&let=6',\n  'ExcelUrl': 'https://excel.codal.ir/service/Excel/GetAll/YLhTbKc77KtnbMHocooRSQ%3d%3d/0',\n  'XbrlUrl': '',\n  'TedanUrl': 'http://www.tedan.ir'},\n {'SuperVision': {'UnderSupervision': 1,\n   'AdditionalInfo': '',\n   'Reasons': ['عدم ارائه صورت\\u200cهای مالی ۱۲ ماهه حسابرسی شدۀ شرکت اصلی و تلفیقی گروه',\n    'عدم ارائه گزارش هیئت\\u200cمدیره به مجمع و اظهارنظر حسابرس در مورد آن',\n    'عدم ارائه گزارش تفسیری مدیریت ۱۲ ماهه حسابرسی شده']},\n  'TracingNo': 825953,\n  'Symbol': 'وبملت',\n  'CompanyName': 'بانک ملت',\n  'UnderSupervision': 0,\n  'Title': 'اطلاعات و صورت\\u200cهای مالی میاندوره\\u200cای تلفیقی دوره ۶ ماهه منتهی به ۱۴۰۰/۰۶/۳۱ (حسابرسی شده)',\n  'LetterCode': 'ن-۱۰',\n  'SentDateTime': '۱۴۰۰/۰۹/۱۵ ۲۲:۰۱:۳۲',\n  'PublishDateTime': '۱۴۰۰/۰۹/۱۵ ۲۲:۰۱:۳۲',\n  'HasHtml': True,\n  'IsEstimate': False,\n  'Url': '/Reports/Decision.aspx?LetterSerial=TLOQ83KhULOFMQQQaQQQYZIZ5H5A%3D%3D&rt=3&let=6&ct=0&ft=-1',\n  'HasExcel': True,\n  'HasPdf': True,\n  'HasXbrl': False,\n  'HasAttachment': True,\n  'AttachmentUrl': '/Reports/Attachment.aspx?LetterSerial=TLOQ83KhULOFMQQQaQQQYZIZ5H5A%3d%3d',\n  'PdfUrl': 'DownloadFile.aspx?hs=TLOQ83KhULOFMQQQaQQQYZIZ5H5A%3d%3d&ft=1005&let=6',\n  'ExcelUrl': 'https://excel.codal.ir/service/Excel/GetAll/TLOQ83KhULOFMQQQaQQQYZIZ5H5A%3d%3d/0',\n  'XbrlUrl': '',\n  'TedanUrl': 'http://www.tedan.ir'},\n {'SuperVision': {'UnderSupervision': 1,\n   'AdditionalInfo': '',\n   'Reasons': ['عدم ارائه صورت\\u200cهای مالی ۱۲ ماهه حسابرسی شدۀ شرکت اصلی و تلفیقی گروه',\n    'عدم ارائه گزارش هیئت\\u200cمدیره به مجمع و اظهارنظر حسابرس در مورد آن',\n    'عدم ارائه گزارش تفسیری مدیریت ۱۲ ماهه حسابرسی شده']},\n  'TracingNo': 768588,\n  'Symbol': 'وبملت',\n  'CompanyName': 'بانک ملت',\n  'UnderSupervision': 0,\n  'Title': 'صورت\\u200cهای مالی تلفیقی سال مالی منتهی به ۱۳۹۹/۱۲/۳۰ (حسابرسی شده)',\n  'LetterCode': 'ن-۱۰',\n  'SentDateTime': '۱۴۰۰/۰۴/۲۰ ۱۱:۲۰:۳۶',\n  'PublishDateTime': '۱۴۰۰/۰۴/۲۰ ۱۱:۲۰:۳۶',\n  'HasHtml': True,\n  'IsEstimate': False,\n  'Url': '/Reports/Decision.aspx?LetterSerial=Qlz4uFzkkEGRvIQUhty5IQ%3D%3D&rt=3&let=6&ct=0&ft=-1',\n  'HasExcel': True,\n  'HasPdf': True,\n  'HasXbrl': False,\n  'HasAttachment': True,\n  'AttachmentUrl': '/Reports/Attachment.aspx?LetterSerial=Qlz4uFzkkEGRvIQUhty5IQ%3d%3d',\n  'PdfUrl': 'DownloadFile.aspx?hs=Qlz4uFzkkEGRvIQUhty5IQ%3d%3d&ft=1005&let=6',\n  'ExcelUrl': 'https://excel.codal.ir/service/Excel/GetAll/Qlz4uFzkkEGRvIQUhty5IQ%3d%3d/0',\n  'XbrlUrl': '',\n  'TedanUrl': 'http://www.tedan.ir'}]\n\n\n\nگرفتن تمام صفحات و ذخیره آن درون شی\n\n\nquery.get_letters()\n\n\nنمایش صفحات ذخیره شده\n\n\nquery.letters\n\n\n\n\n\n\n\n\n\npublish_date_time\nsent_date_time\ntracing_no\nletter_serial\nletter_code\nletter_types\nletter_title\ncompany_symbol\ncompany_name\n\n\n\n\n0\n14020915200335\n14020915200335\n1116260\nOVLjMIHaAZsXZK6TitYWxQ%3d%3d\nن-10\nصورت های مالی میان دوره ای\nاطلاعات و صورت‌های مالی میاندوره‌ای تلفیقی دور...\nوبملت\nبانک ملت\n\n\n1\n14020328202954\n14020328202954\n1041366\n5mk9zW2T9eTUWjPZUakQQQaQQQ8A%3d%3d\nن-10\nصورت های مالی میان دوره ای\nصورت‌های مالی تلفیقی سال مالی منتهی به 1401/12...\nوبملت\nبانک ملت\n\n\n2\n14010915195657\n14010915195657\n966408\nOrRG4vaz36UjbkVcznu8fA%3d%3d\nن-10\nصورت های مالی میان دوره ای\nاطلاعات و صورت‌های مالی میاندوره‌ای تلفیقی دور...\nوبملت\nبانک ملت\n\n\n3\n14010329000201\n14010329000201\n896865\nYLhTbKc77KtnbMHocooRSQ%3d%3d\nن-10\nصورت های مالی میان دوره ای\nصورت‌های مالی تلفیقی سال مالی منتهی به 1400/12...\nوبملت\nبانک ملت\n\n\n4\n14000915220132\n14000915220132\n825953\nTLOQ83KhULOFMQQQaQQQYZIZ5H5A%3D%3D\nن-10\nصورت های مالی میان دوره ای\nاطلاعات و صورت‌های مالی میاندوره‌ای تلفیقی دور...\nوبملت\nبانک ملت\n\n\n5\n14000420112036\n14000420112036\n768588\nQlz4uFzkkEGRvIQUhty5IQ%3D%3D\nن-10\nصورت های مالی میان دوره ای\nصورت‌های مالی تلفیقی سال مالی منتهی به 1399/12...\nوبملت\nبانک ملت\n\n\n\n\n\n\n\n\n\nگرفتن و ذخیره لیست گزارشات برای چند نماد با سرعت بالا در دیتابیس\n\n\nfrom codal_tsetmc.download.codal.letters import update_letters_table\n\nupdate_letters_table(query, [\"فولاد\", \"فملی\", \"شپنا\"])\n\nrelation \"letters\" already exists\nrelation \"letters\" already exists\nrelation \"letters\" already exists\nupdate_letter_table_by_urls:  None\n\n\n\nگرفتن لیست گزارشات نماد خاص در دیتابیس\n\n\nfrom codal_tsetmc.tools.database import read_table_by_conditions\n\nread_table_by_conditions(table=\"letters\", variable=\"symbol\", value=\"فولاد\")\n\n\n\n\n\n\n\n\n\npublish_date_time\nsent_date_time\ntracing_no\nletter_serial\nletter_code\nletter_types\nletter_title\nsymbol\nname\n\n\n\n\n0\n14020426214952\n14020426214952\n1055774\nSS97V5jtRN0QQQaQQQscZebQQQaQQQvRwg%3d%3d\nن-10\nصورت های مالی میان دوره ای\nصورت‌های مالی تلفیقی سال مالی منتهی به 1401/12...\nفولاد\nفولاد مبارکه اصفهان\n\n\n1\n14021107184454\n14021107184454\n1096229\n4aQQQaQQQJI3W6uTKLoHuoFjH7zA%3d%3d\nن-10\nصورت های مالی میان دوره ای\nاطلاعات و صورت‌های مالی میاندوره‌ای تلفیقی دور...\nفولاد\nفولاد مبارکه اصفهان\n\n\n2\n14011029125540\n14011029125540\n982256\nQQQaQQQtdXtHxpzUX3vJk1C1JfUw%3d%3d\nن-10\nصورت های مالی میان دوره ای\nاطلاعات و صورت‌های مالی میاندوره‌ای تلفیقی دور...\nفولاد\nفولاد مبارکه اصفهان\n\n\n3\n14010509103042\n14010509103042\n912864\nAuFIYwI3LY424zd3p4ij5A%3d%3d\nن-10\nصورت های مالی میان دوره ای\nصورت‌های مالی تلفیقی سال مالی منتهی به 1400/12...\nفولاد\nفولاد مبارکه اصفهان\n\n\n4\n14001124155735\n14001124155735\n852911\ncQd9yigizoTueJdP5SZofw%3D%3D\nن-10\nصورت های مالی میان دوره ای\nاطلاعات و صورت‌های مالی میاندوره‌ای تلفیقی دور...\nفولاد\nفولاد مبارکه اصفهان\n\n\n5\n14000507165312\n14000507165312\n762282\nNDR8Dkp6Fm%2BEHtNIfHDW5A%3D%3D\nن-10\nصورت های مالی میان دوره ای\nصورت‌های مالی تلفیقی سال مالی منتهی به 1399/12...\nفولاد\nفولاد مبارکه اصفهان\n\n\n\n\n\n\n\n\n\nگرفتن لیست گزارشات از دیتابیس با کوئری\n\n\nfrom codal_tsetmc.tools.database import read_table_by_sql_query\n\ndf = read_table_by_sql_query(\n  \"\"\"\n  SELECT *\n  FROM letters \n  WHERE symbol IN (\n    'فولاد',\n    'فملی',\n    'شپنا'\n  )\n  \"\"\"\n)\n\ndf.head()\n\n\n\n\n\n\n\n\n\npublish_date_time\nsent_date_time\ntracing_no\nletter_serial\nletter_code\nletter_types\nletter_title\nsymbol\nname\n\n\n\n\n0\n14020426214952\n14020426214952\n1055774\nSS97V5jtRN0QQQaQQQscZebQQQaQQQvRwg%3d%3d\nن-10\nصورت های مالی میان دوره ای\nصورت‌های مالی تلفیقی سال مالی منتهی به 1401/12...\nفولاد\nفولاد مبارکه اصفهان\n\n\n1\n14020916021316\n14020916021316\n1117547\nm7Al4zMK6ehzTl5IYHXJMw%3d%3d\nن-10\nصورت های مالی میان دوره ای\nاطلاعات و صورت‌های مالی میاندوره‌ای تلفیقی دور...\nفملی\nملی صنایع مس ایران\n\n\n2\n14020421234934\n14020421234934\n1053560\nuNTArPkEcdZwlQ3qCxrlGA%3d%3d\nن-10\nصورت های مالی میان دوره ای\nصورت‌های مالی تلفیقی سال مالی منتهی به 1401/12...\nفملی\nملی صنایع مس ایران\n\n\n3\n14010915211100\n14010915211100\n967888\nysRiJ5CYn9VX%2bdsPleOp8A%3d%3d\nن-10\nصورت های مالی میان دوره ای\nاطلاعات و صورت‌های مالی میاندوره‌ای تلفیقی دور...\nفملی\nملی صنایع مس ایران\n\n\n4\n14010418192728\n14010418192728\n909751\nlsZrb35rwgAN7wObVrYtKw%3d%3d\nن-10\nصورت های مالی میان دوره ای\nصورت‌های مالی تلفیقی سال مالی منتهی به 1400/12...\nفملی\nملی صنایع مس ایران",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>کدال</span>"
    ]
  },
  {
    "objectID": "tsetmc.html",
    "href": "tsetmc.html",
    "title": "بورس تهران",
    "section": "",
    "text": "اطلاعات سهام",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>بورس تهران</span>"
    ]
  },
  {
    "objectID": "tsetmc.html#اطلاعات-سهام",
    "href": "tsetmc.html#اطلاعات-سهام",
    "title": "بورس تهران",
    "section": "",
    "text": "اطلاعات نماد\nهمانطور که می‌دانید در سایت بورس ایران سهام‌ها به همراه نمادشان یک کد یکتا هم دارند که برای هر نماد در هر وضعیت بورسی یک کد خاص اختصاص دارد برای مثال برای نماد دي در بازار دوم فرابورس کد 44818950263583523 و در بازار پایه زرد فرابورس کد 66416853783916493 در نظر گرفته شده است.\n\n# نماد شاخص کل\nshakhes_code = \"32097828799138957\"\n# نماد دي در بازار دوم فرابورس\ndey_scnd_code = \"44818950263583523\"\n# نماد دي در بازار پایه فرابورس\ndey_paye_code = \"66416853783916493\"\n# نماد فولاد در بازار اول بورس\nfolad_code = \"46348559193224090\"\n# نماد فملي در بازار اول بورس\nfameli_code = \"35425587644337450\"\n\n# گروه استخراج زغال سنگ\ncoal_group = \"10\"\n\nبرای گرفتن اطلاعات نماد به صورت لحظه‌ای می‌توان از کد زیر استفاده کرد\n\nfrom codal_tsetmc import get_stock_detail\n\npp.pprint(get_stock_detail(dey_scnd_code))\n\nprint(\"=\"*50)\n\npp.pprint(get_stock_detail(dey_paye_code))\n\n{'capital': 135000000000.0,\n 'code': '44818950263583523',\n 'group_code': '57',\n 'group_name': 'بانكها و موسسات اعتباري',\n 'group_type': 'Z1',\n 'instrument_code': '44818950263583523',\n 'instrument_id': 'IRO3BDYZ0001',\n 'isin': 'IRO3BDYZ0003',\n 'market_code': 2,\n 'market_name': 'بازار فرابورس',\n 'market_type': 'بازار دوم فرابورس',\n 'name': 'بانك دي',\n 'name_en': 'Day Bank',\n 'symbol': 'دي'}\n==================================================\n{'capital': 135000000000.0,\n 'code': '66416853783916493',\n 'group_code': '57',\n 'group_name': 'بانكها و موسسات اعتباري',\n 'group_type': 'P1',\n 'instrument_code': '66416853783916493',\n 'instrument_id': 'IRO7BDYZ0001',\n 'isin': 'IRO7BDYZ0009',\n 'market_code': 4,\n 'market_name': 'بازار پایه فرابورس',\n 'market_type': 'بازار پایه زرد فرابورس',\n 'name': 'بانك دي',\n 'name_en': 'Day Bank',\n 'symbol': 'دي'}\n\n\nدر دیتابیس جدولی به اسم stocks تعبیه شده که می‌توانید اطلاعات نمادها را در آن ذخیره کنید.\nبرای گرفتن و ذخیره اطلاعات یک نماد در دیتابیس از کد زیر استفاده میکنیم\n\nfrom codal_tsetmc import update_stock_table\n\nupdate_stock_table(dey_paye_code)\n\nStock exist: (code: 66416853783916493, symbol: دي).\n\n\nبرای گرفتن و ذخیره اطلاعات چند نماد در دیتابیس از کد زیر استفاده میکنیم\n\nfrom codal_tsetmc import update_stocks_table\n\nupdate_stocks_table([dey_paye_code, dey_scnd_code, shakhes_code])\n\nStock exist: (code: 66416853783916493, symbol: دي).\nStock exist: (code: 44818950263583523, symbol: دي).\nStock exist: (code: 32097828799138957, symbol: شاخص كل6).\n\n\nاگر جدول stocks در دیتابیس را مشاهده کنید اطلاعات باید به صورت زیر نمایش داده شود.\n\n\n\nاطلاعات ذخیره شده بانک دی در دیتابیس\n\n\nمی‌توانید با کد زیر به شیوه‌های مختلف به اطلاعات دسترسی داشته باشید.\n\nfrom codal_tsetmc import read_table_by_conditions\n\nread_table_by_conditions(\n    table=\"stocks\",\n    variable=\"name\",\n    value=\"بانك دي\"\n)\n\n\n\n\n\n\n\n\n\nid\nsymbol\nname\nname_en\nisin\ncode\ncapital\ninstrument_code\ninstrument_id\ngroup_name\ngroup_code\ngroup_type\nmarket_name\nmarket_code\nmarket_type\n\n\n\n\n0\n573\nدي\nبانك دي\nDay Bank\nIRO7BDYZ0009\n66416853783916493\n135000000000\n66416853783916493\nIRO7BDYZ0001\nبانكها و موسسات اعتباري\n57\nP1\nبازار پایه فرابورس\n4\nبازار پایه زرد فرابورس\n\n\n1\n2308\nدي\nبانك دي\nDay Bank\nIRO3BDYZ0003\n44818950263583523\n135000000000\n44818950263583523\nIRO3BDYZ0001\nبانكها و موسسات اعتباري\n57\nZ1\nبازار فرابورس\n2\nبازار دوم فرابورس\n\n\n\n\n\n\n\n\n\nfrom codal_tsetmc import read_table_by_sql_query\n\nread_table_by_sql_query(\n    f\"\"\"\n    SELECT *\n    FROM stocks\n    WHERE name = 'بانك دي'\n    \"\"\"\n)\n\n\n\n\n\n\n\n\n\nid\nsymbol\nname\nname_en\nisin\ncode\ncapital\ninstrument_code\ninstrument_id\ngroup_name\ngroup_code\ngroup_type\nmarket_name\nmarket_code\nmarket_type\n\n\n\n\n0\n573\nدي\nبانك دي\nDay Bank\nIRO7BDYZ0009\n66416853783916493\n135000000000\n66416853783916493\nIRO7BDYZ0001\nبانكها و موسسات اعتباري\n57\nP1\nبازار پایه فرابورس\n4\nبازار پایه زرد فرابورس\n\n\n1\n2308\nدي\nبانك دي\nDay Bank\nIRO3BDYZ0003\n44818950263583523\n135000000000\n44818950263583523\nIRO3BDYZ0001\nبانكها و موسسات اعتباري\n57\nZ1\nبازار فرابورس\n2\nبازار دوم فرابورس\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nهشدار\n\n\n\nهمانطور که می‌بینید استفاده از نماد یا نام آن برای دسترسی به اطلاعات لزوما روش مناسبی نیست و بهتر است برای دقت بیشتر از کد مربوط به آن نماد استفاده شود.\n\n\nبرای افزودن اطلاعات تمام نماد‌های می‌توان از کد زیر استفاده کرد.\n\nfrom codal_tsetmc import fill_stocks_table\n\nfill_stocks_table()\n\nstock with code 19101865588701374 exist\nstock with code 24455170564393447 exist\nstock with code 67327029014085707 exist\n...\n...\nstock with code 65157472039220905 exist\nstock with code 6858820559759769 exist\nstock with code 69171897374421261 exist\n\n\nاطلاعات گروه\nبرای گرفتن گروه‌های نماد‌ها می‌توان از کد زیر استفاده کرد.\n\nfrom codal_tsetmc import get_stocks_groups\n\nget_stocks_groups()\n\n\n\n\n\n\n\n\n\nid\ncode\ntype\nname\ndescription\n\n\n\n\n0\n1\n1\nPaperType\nسهام ...\nنمایش اوراق سهام در دیده بان ...\n\n\n1\n2\n2\nPaperType\nفرابورس - بازار پایه ...\nنمایش اوراق بازار پایه در دیده بان ...\n\n\n2\n4\n3\nPaperType\nتسهیلات مسکن ...\nنمایش اوراق تسهیلات مسکن در دیده بان ...\n\n\n3\n6\n4\nPaperType\nحق تقدم ...\nنمایش اوراق حق تقدم در دیده بان ...\n\n\n4\n7\n5\nPaperType\nاوراق بدهی ...\nنمایش اوراق بدهی در دیده بان ...\n\n\n...\n...\n...\n...\n...\n...\n\n\n70\n96\n74\nIndustrialGroup\nخدمات فني و مهندسي ...\nخدمات فني و مهندسي ...\n\n\n71\n97\n76\nIndustrialGroup\nاوراق بهادار مبتني بر دارايي فكري ...\nاوراق بهادار مبتني بر دارايي فكري ...\n\n\n72\n98\n77\nIndustrialGroup\nفعالبت هاي اجاره و ليزينگ ...\nفعالبت هاي اجاره و ليزينگ ...\n\n\n73\n99\n82\nIndustrialGroup\nفعاليت پشتيباني اجرائي اداري وحمايت كسب ...\nفعاليت پشتيباني اجرائي اداري وحمايت كسب ...\n\n\n74\n100\n90\nIndustrialGroup\nفعاليت هاي هنري، سرگرمي و خلاقانه ...\nفعاليت هاي هنري، سرگرمي و خلاقانه ...\n\n\n\n\n75 rows × 5 columns\n\n\n\n\nاز کد زیر برای ذخیره سازی آن‌ها در جدول stocks_groups در دیتابیس می‌توان استفاده کرد.\n\nfrom codal_tsetmc import fill_stocks_groups_table\n\nfill_stocks_groups_table()",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>بورس تهران</span>"
    ]
  },
  {
    "objectID": "tsetmc.html#قیمت-سهام",
    "href": "tsetmc.html#قیمت-سهام",
    "title": "بورس تهران",
    "section": "قیمت سهام",
    "text": "قیمت سهام\nقیمت هر سهم رو می‌توان از کد زیر دریافت کرد.\n\nfrom codal_tsetmc import get_stock_price_daily\n\ndate = \"14030201\"\n\nget_stock_price_daily(folad_code, date)\n\n4878.0\n\n\nبرای هر سهم می‌توان داده‌های تاریخی قیمتی آن را با استفاده از کد زیر دریافت کرد.\n\nfrom codal_tsetmc import get_stock_prices_history\n\nget_stock_prices_history(folad_code)\n\n\n\n\n\n\n\n\n\ndate\nhigh\nlow\nprice\nclose\nopen\nyesterday\nvalue\nvolume\ncount\ncode\n\n\n\n\n0\n2024-06-12\n4980.0\n4832.0\n4878.0\n4907.0\n4925.0\n4906.0\n5.030077e+11\n103122327\n5049\n46348559193224090\n\n\n1\n2024-06-11\n4985.0\n4870.0\n4906.0\n4920.0\n4921.0\n4919.0\n4.022133e+11\n81983014\n3388\n46348559193224090\n\n\n2\n2024-06-10\n4920.0\n4862.0\n4919.0\n4920.0\n4920.0\n4824.0\n4.460094e+11\n90678531\n3088\n46348559193224090\n\n\n3\n2024-06-09\n4874.0\n4741.0\n4824.0\n4872.0\n4763.0\n4779.0\n4.109409e+11\n85180576\n4350\n46348559193224090\n\n\n4\n2024-06-08\n4890.0\n4777.0\n4779.0\n4777.0\n4889.0\n4874.0\n3.829501e+11\n80125306\n3295\n46348559193224090\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n3809\n2007-03-17\n1927.0\n1896.0\n1898.0\n1898.0\n1896.0\n1934.0\n2.823901e+10\n14877283\n1514\n46348559193224090\n\n\n3810\n2007-03-14\n1966.0\n1934.0\n1934.0\n1934.0\n1934.0\n1973.0\n5.166638e+10\n26705128\n1901\n46348559193224090\n\n\n3811\n2007-03-13\n1976.0\n1915.0\n1973.0\n1973.0\n1976.0\n1938.0\n2.492415e+11\n126270939\n5862\n46348559193224090\n\n\n3812\n2007-03-12\n1938.0\n1938.0\n1938.0\n1938.0\n1938.0\n1900.0\n1.938795e+11\n100041000\n9214\n46348559193224090\n\n\n3813\n2007-03-11\n1938.0\n1900.0\n1900.0\n1900.0\n1900.0\n1900.0\n8.894372e+11\n468077431\n7736\n46348559193224090\n\n\n\n\n3814 rows × 11 columns\n\n\n\n\nبرای شاخص کل می‌توان داده‌های تاریخی قیمت آن را با استفاده از کد زیر دریافت کرد.\n\nfrom codal_tsetmc import get_index_prices_history\n\nget_index_prices_history()\n\n\n\n\n\n\n\n\n\ndate\nprice\ncode\nsymbol\nvalue\nvolume\nup_date\n\n\n\n\n0\n13870914000000\n9248.9\n32097828799138957\nشاخص كل6\n&lt;NA&gt;\n&lt;NA&gt;\n14030324000000\n\n\n1\n13870915000000\n9248.9\n32097828799138957\nشاخص كل6\n&lt;NA&gt;\n&lt;NA&gt;\n14030324000000\n\n\n2\n13870916000000\n9178.3\n32097828799138957\nشاخص كل6\n&lt;NA&gt;\n&lt;NA&gt;\n14030324000000\n\n\n3\n13870917000000\n9130.5\n32097828799138957\nشاخص كل6\n&lt;NA&gt;\n&lt;NA&gt;\n14030324000000\n\n\n4\n13870918000000\n9089.2\n32097828799138957\nشاخص كل6\n&lt;NA&gt;\n&lt;NA&gt;\n14030324000000\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n3740\n14030319000000\n2064389.5\n32097828799138957\nشاخص كل6\n&lt;NA&gt;\n&lt;NA&gt;\n14030324000000\n\n\n3741\n14030320000000\n2061897.1\n32097828799138957\nشاخص كل6\n&lt;NA&gt;\n&lt;NA&gt;\n14030324000000\n\n\n3742\n14030321000000\n2078090.7\n32097828799138957\nشاخص كل6\n&lt;NA&gt;\n&lt;NA&gt;\n14030324000000\n\n\n3743\n14030322000000\n2081296.9\n32097828799138957\nشاخص كل6\n&lt;NA&gt;\n&lt;NA&gt;\n14030324000000\n\n\n3744\n14030323000000\n2075720.5\n32097828799138957\nشاخص كل6\n&lt;NA&gt;\n&lt;NA&gt;\n14030324000000\n\n\n\n\n3745 rows × 7 columns\n\n\n\n\nبرای ذخیره سازی داده‌های تاریخی قیمت هر سهم در دیتابیس می‌توان از کد زیر استفاده کرد.\n\nfrom codal_tsetmc import update_stock_prices\n\nupdate_stock_prices(folad_code)\n\nStock prices already updated. (code: 46348559193224090, symbol: فولاد)\n\n\nبرای ذخیره سازی داده‌های تاریخی قیمت شاخص کل در دیتابیس می‌توان از کد زیر استفاده کرد.\n\nfrom codal_tsetmc import update_index_prices\n\nupdate_index_prices()\n\nTable stocks_prices updated.\nStock prices updated. (code: 32097828799138957, symbol: شاخص كل6)\n\n\nبرای ذخیره سازی چند سهام می‌توان از کد زیر استفاده کرد.\n\nfrom codal_tsetmc import update_stocks_prices\n\nupdate_stocks_prices([folad_code, fameli_code])\n\nStock prices already updated. (code: 46348559193224090, symbol: فولاد)\nStock prices already updated. (code: 35425587644337450, symbol: فملي)\n\n\nبا استفاده از کد زیر می‌توان داده‌های قیمتی گروه خاصی از سهام‌ها را بروز کرد.\n\nfrom codal_tsetmc import update_stocks_group_prices\n\nupdate_stocks_group_prices(group_code=coal_group)\n\nStarted group: 10\nStock prices already updated. (code: 42690477960659940, symbol: كشرق)\nStock prices already updated. (code: 22941065011246116, symbol: كپرور)\nTable stocks_prices updated.\nStock prices updated. (code: 8977369674477111, symbol: كطبس)\nFinished group: 10\n\n\nمی‌توانید با کد زیر به شیوه‌های مختلف به اطلاعات قیمتی دسترسی داشته باشید.\n\nfrom codal_tsetmc import read_table_by_conditions\n\nread_table_by_conditions(\n    table=\"stocks_prices\",\n    variable=\"code\",\n    value=folad_code\n)\n\n\n\n\n\n\n\n\n\nid\ncode\nsymbol\ndate\nvolume\nvalue\nprice\nup_date\n\n\n\n\n0\n141559\n46348559193224090\nفولاد\n13851220000000\n468077431\n889437216900\n1900.0\n14030324000000\n\n\n1\n141560\n46348559193224090\nفولاد\n13851221000000\n100041000\n193879458000\n1938.0\n14030324000000\n\n\n2\n141561\n46348559193224090\nفولاد\n13851222000000\n126270939\n249241504527\n1973.0\n14030324000000\n\n\n3\n141562\n46348559193224090\nفولاد\n13851223000000\n26705128\n51666379451\n1934.0\n14030324000000\n\n\n4\n141563\n46348559193224090\nفولاد\n13851226000000\n14877283\n28239006789\n1898.0\n14030324000000\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n3808\n145367\n46348559193224090\nفولاد\n14030319000000\n80125306\n382950141459\n4779.0\n14030324000000\n\n\n3809\n145368\n46348559193224090\nفولاد\n14030320000000\n85180576\n410940861464\n4824.0\n14030324000000\n\n\n3810\n145369\n46348559193224090\nفولاد\n14030321000000\n90678531\n446009397576\n4919.0\n14030324000000\n\n\n3811\n145370\n46348559193224090\nفولاد\n14030322000000\n81983014\n402213337484\n4906.0\n14030324000000\n\n\n3812\n145371\n46348559193224090\nفولاد\n14030323000000\n103122327\n503007695975\n4878.0\n14030324000000\n\n\n\n\n3813 rows × 8 columns\n\n\n\n\n\nfrom codal_tsetmc import read_table_by_sql_query\n\nread_table_by_sql_query(\n    f\"\"\"\n    SELECT *\n    FROM stocks_prices\n    WHERE code = '{folad_code}'\n    \"\"\"\n)\n\n\n\n\n\n\n\n\n\nid\ncode\nsymbol\ndate\nvolume\nvalue\nprice\nup_date\n\n\n\n\n0\n141559\n46348559193224090\nفولاد\n13851220000000\n468077431\n889437216900\n1900.0\n14030324000000\n\n\n1\n141560\n46348559193224090\nفولاد\n13851221000000\n100041000\n193879458000\n1938.0\n14030324000000\n\n\n2\n141561\n46348559193224090\nفولاد\n13851222000000\n126270939\n249241504527\n1973.0\n14030324000000\n\n\n3\n141562\n46348559193224090\nفولاد\n13851223000000\n26705128\n51666379451\n1934.0\n14030324000000\n\n\n4\n141563\n46348559193224090\nفولاد\n13851226000000\n14877283\n28239006789\n1898.0\n14030324000000\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n3808\n145367\n46348559193224090\nفولاد\n14030319000000\n80125306\n382950141459\n4779.0\n14030324000000\n\n\n3809\n145368\n46348559193224090\nفولاد\n14030320000000\n85180576\n410940861464\n4824.0\n14030324000000\n\n\n3810\n145369\n46348559193224090\nفولاد\n14030321000000\n90678531\n446009397576\n4919.0\n14030324000000\n\n\n3811\n145370\n46348559193224090\nفولاد\n14030322000000\n81983014\n402213337484\n4906.0\n14030324000000\n\n\n3812\n145371\n46348559193224090\nفولاد\n14030323000000\n103122327\n503007695975\n4878.0\n14030324000000\n\n\n\n\n3813 rows × 8 columns\n\n\n\n\nپر کردن جدول قیمت کل شرکت‌ها\n\nfrom codal_tsetmc import fill_stocks_prices_table\n\nfill_stocks_prices_table()\n\nstock: 51810394260474149  group: 69 total progress: 1.89%\n...\nPrice Download Finished.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>بورس تهران</span>"
    ]
  },
  {
    "objectID": "tsetmc.html#افزایش-سرمایه-شرکت",
    "href": "tsetmc.html#افزایش-سرمایه-شرکت",
    "title": "بورس تهران",
    "section": "افزایش سرمایه شرکت",
    "text": "افزایش سرمایه شرکت\nگرفتن افزایش سرمایه سهم به صورت روزانه\n\nfrom codal_tsetmc import get_stock_capital_daily\n\nget_stock_capital_daily(folad_code)\n\n1080000000000.0\n\n\nگرفتن افزایش سرمایه تاریخی سهم\n\nfrom codal_tsetmc import get_stock_capitals_history\n\nget_stock_capitals_history(folad_code)\n\n\n\n\n\n\n\n\n\ndate\nnew\nold\ncode\nsymbol\n\n\n\n\n9\n13891125000000\n2.580000e+10\n1.580000e+10\n46348559193224090\nفولاد\n\n\n8\n13920505000000\n3.600000e+10\n2.580000e+10\n46348559193224090\nفولاد\n\n\n7\n13930515000000\n5.000000e+10\n3.600000e+10\n46348559193224090\nفولاد\n\n\n6\n13940726000000\n7.500000e+10\n5.000000e+10\n46348559193224090\nفولاد\n\n\n5\n13971130000000\n1.300000e+11\n7.500000e+10\n46348559193224090\nفولاد\n\n\n4\n13981022000000\n2.090000e+11\n1.300000e+11\n46348559193224090\nفولاد\n\n\n3\n14000303000000\n2.930000e+11\n2.090000e+11\n46348559193224090\nفولاد\n\n\n2\n14010518000000\n5.300000e+11\n2.930000e+11\n46348559193224090\nفولاد\n\n\n1\n14011228000000\n8.000000e+11\n5.300000e+11\n46348559193224090\nفولاد\n\n\n0\n14021208000000\n1.080000e+12\n8.000000e+11\n46348559193224090\nفولاد\n\n\n\n\n\n\n\n\nبروزرسانی جدول افزایش سرمایه در دیتابیس برای یک سهم\n\nfrom codal_tsetmc import update_stock_capitals\n\nupdate_stock_capitals(folad_code)\n\nبروزرسانی جدول افزایش سرمایه در دیتابیس برای چند سهم\n\nfrom codal_tsetmc import update_stocks_capitals\n\nupdate_stocks_capitals([folad_code, fameli_code])\n\nبروزرسانی جدول افزایش سرمایه در دیتابیس برای گروهی از سهام‌ها\n\nfrom codal_tsetmc import update_stocks_group_capitals\n\nupdate_stocks_group_capitals(coal_group)\n\nStocks group: 10 Started.\nStock Capital Failed. (code: 42690477960659940, symbol: كشرق) None\nStocks group: 10 Finished.\n\n\nپر کردن جدول افزایش سرمایه‌ها\n\nfrom codal_tsetmc import fill_stocks_capitals_table\n\nfill_stocks_capitals_table()\n\nstock: 51810394260474149  group: 69 total progress: 1.89%\n...\nCapital Download Finished.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>بورس تهران</span>"
    ]
  },
  {
    "objectID": "tsetmc.html#ساختن-یک-شی-سهام",
    "href": "tsetmc.html#ساختن-یک-شی-سهام",
    "title": "بورس تهران",
    "section": "ساختن یک شی سهام",
    "text": "ساختن یک شی سهام\n\nfrom codal_tsetmc import Stocks\n\nstock = Stocks.query.filter_by(code=folad_code).first()\nstock\n\nsymbol: فولاد, code: 46348559193224090, name: فولاد مباركه اصفهان, group: فلزات اساسي\n\n\nمشاهده مشخصات سهم\n\nprint(f\"\"\"\nsymbol: {stock.symbol}\nname: {stock.name}\nname_en: {stock.name_en}\nisin: {stock.isin}\ncode: {stock.code}\ninstrument_code: {stock.instrument_code}\ninstrument_id: {stock.instrument_id}\ngroup_code: {stock.group_code}\ngroup_name: {stock.group_name}\ngroup_type: {stock.group_type}\nmarket_code: {stock.market_code}\nmarket_name: {stock.market_name}\nmarket_type: {stock.market_type}\nprice: {stock.price}\ncapital: {stock.capital}\ncap: {stock.cap}\n\"\"\")\n\n\nsymbol: فولاد\nname: فولاد مباركه اصفهان\nname_en: S*Mobarakeh Steel\nisin: IRO1FOLD0009\ncode: 46348559193224090\ninstrument_code: 46348559193224090\ninstrument_id: IRO1FOLD0001\ngroup_code: 27\ngroup_name: فلزات اساسي\ngroup_type: N1\nmarket_code: 1\nmarket_name: بازار بورس\nmarket_type: بازار اول (تابلوی اصلی) بورس\nprice: 4878.0\ncapital: 1080000000000\ncap: 1080000000000\n\n\n\nگرفتن اطلاعات قیمت تاریخی سهم\n\nstock.prices\n\n\n\n\n\n\n\n\n\njdate\nsymbol\ncode\nprice\nvalue\nvolume\n\n\ndate\n\n\n\n\n\n\n\n\n\n\n2007-03-11\n13851220\nفولاد\n46348559193224090\n1900.0\n889437216900\n468077431\n\n\n2007-03-12\n13851221\nفولاد\n46348559193224090\n1938.0\n193879458000\n100041000\n\n\n2007-03-13\n13851222\nفولاد\n46348559193224090\n1973.0\n249241504527\n126270939\n\n\n2007-03-14\n13851223\nفولاد\n46348559193224090\n1934.0\n51666379451\n26705128\n\n\n2007-03-17\n13851226\nفولاد\n46348559193224090\n1898.0\n28239006789\n14877283\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n2024-06-08\n14030319\nفولاد\n46348559193224090\n4779.0\n382950141459\n80125306\n\n\n2024-06-09\n14030320\nفولاد\n46348559193224090\n4824.0\n410940861464\n85180576\n\n\n2024-06-10\n14030321\nفولاد\n46348559193224090\n4919.0\n446009397576\n90678531\n\n\n2024-06-11\n14030322\nفولاد\n46348559193224090\n4906.0\n402213337484\n81983014\n\n\n2024-06-12\n14030323\nفولاد\n46348559193224090\n4878.0\n503007695975\n103122327\n\n\n\n\n3813 rows × 6 columns\n\n\n\n\nگرفتن اطلاعات افزایش سرمایه تاریخی سهم\n\nstock.capitals\n\n\n\n\n\n\n\n\n\njdate\nsymbol\ncode\nold\nnew\n\n\ndate\n\n\n\n\n\n\n\n\n\n2011-02-14\n13891125\nفولاد\n46348559193224090\n15800000000\n25800000000\n\n\n2013-07-27\n13920505\nفولاد\n46348559193224090\n25800000000\n36000000000\n\n\n2014-08-06\n13930515\nفولاد\n46348559193224090\n36000000000\n50000000000\n\n\n2015-10-18\n13940726\nفولاد\n46348559193224090\n50000000000\n75000000000\n\n\n2019-02-19\n13971130\nفولاد\n46348559193224090\n75000000000\n130000000000\n\n\n2020-01-12\n13981022\nفولاد\n46348559193224090\n130000000000\n209000000000\n\n\n2021-05-24\n14000303\nفولاد\n46348559193224090\n209000000000\n293000000000\n\n\n2022-08-09\n14010518\nفولاد\n46348559193224090\n293000000000\n530000000000\n\n\n2023-03-19\n14011228\nفولاد\n46348559193224090\n530000000000\n800000000000\n\n\n2024-02-27\n14021208\nفولاد\n46348559193224090\n800000000000\n1080000000000\n\n\n\n\n\n\n\n\nگرفتن اطلاعات ارزش بازار تاریخی سهم\n\nstock.market\n\n\n\n\n\n\n\n\n\njdate\nsymbol\ncode\ncapital\nmarket\nvalue\n\n\ndate\n\n\n\n\n\n\n\n\n\n\n2007-03-11\n13851220\nفولاد\n46348559193224090\n1.580000e+10\n3.002000e+13\n8.894372e+11\n\n\n2007-03-12\n13851221\nفولاد\n46348559193224090\n1.580000e+10\n3.062040e+13\n1.938795e+11\n\n\n2007-03-13\n13851222\nفولاد\n46348559193224090\n1.580000e+10\n3.117340e+13\n2.492415e+11\n\n\n2007-03-14\n13851223\nفولاد\n46348559193224090\n1.580000e+10\n3.055720e+13\n5.166638e+10\n\n\n2007-03-17\n13851226\nفولاد\n46348559193224090\n1.580000e+10\n2.998840e+13\n2.823901e+10\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n2024-06-08\n14030319\nفولاد\n46348559193224090\n1.080000e+12\n5.161320e+15\n3.829501e+11\n\n\n2024-06-09\n14030320\nفولاد\n46348559193224090\n1.080000e+12\n5.209920e+15\n4.109409e+11\n\n\n2024-06-10\n14030321\nفولاد\n46348559193224090\n1.080000e+12\n5.312520e+15\n4.460094e+11\n\n\n2024-06-11\n14030322\nفولاد\n46348559193224090\n1.080000e+12\n5.298480e+15\n4.022133e+11\n\n\n2024-06-12\n14030323\nفولاد\n46348559193224090\n1.080000e+12\n5.268240e+15\n5.030077e+11\n\n\n\n\n3813 rows × 6 columns\n\n\n\n\nگرفتن اطلاعات ارزش بازار موازی با شاخص تاریخی سهم\n\nstock.index\n\n\n\n\n\n\n\n\n\njdate\nsymbol\nmarket\nindex\n\n\ndate\n\n\n\n\n\n\n\n\n2008-12-04\n13870913\nفولاد\n3.581860e+13\n9248.9\n\n\n2008-12-05\n13870913\nفولاد\n3.581860e+13\n9248.9\n\n\n2008-12-06\n13870916\nفولاد\n3.474420e+13\n9178.3\n\n\n2008-12-07\n13870917\nفولاد\n3.371720e+13\n9130.5\n\n\n2008-12-08\n13870918\nفولاد\n3.270600e+13\n9089.2\n\n\n...\n...\n...\n...\n...\n\n\n2024-06-08\n14030319\nفولاد\n5.161320e+15\n2064389.5\n\n\n2024-06-09\n14030320\nفولاد\n5.209920e+15\n2061897.1\n\n\n2024-06-10\n14030321\nفولاد\n5.312520e+15\n2078090.7\n\n\n2024-06-11\n14030322\nفولاد\n5.298480e+15\n2081296.9\n\n\n2024-06-12\n14030323\nفولاد\n5.268240e+15\n2075720.5\n\n\n\n\n3745 rows × 4 columns\n\n\n\n\nضریب بتای سهم\n\nstock.beta(during=3650)\n\n1.3780854971322487",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>بورس تهران</span>"
    ]
  },
  {
    "objectID": "tsetmc.html#رسم-نمودار",
    "href": "tsetmc.html#رسم-نمودار",
    "title": "بورس تهران",
    "section": "رسم نمودار",
    "text": "رسم نمودار\nبرای رسم نمودار می‌توان از کد زیر استفاده کرد که توضیح آن از بحث ما خارج است.\n\nimport plotly.express as px \nfrom plotly.subplots import make_subplots\nimport plotly.graph_objects as go\n\nfig = make_subplots(\n    rows=2, row_heights=[0.8, 0.2],\n    cols=1, column_widths=[1],\n    shared_xaxes=True,\n    specs=[[{\"secondary_y\": True}], [{\"secondary_y\": True}]]\n)\n\nfig.add_trace(\n    go.Scatter(\n        name=\"ارزش معاملات\",\n        x=stock.prices[\"jdate\"].jalali.parse_jalali(\"%Y%m%d\"),\n        y=stock.prices[\"value\"]/1e7,\n        stackgroup='one',\n        marker_size=1,\n        mode=\"lines\",\n        line_color='blue',\n        hovertemplate='&lt;b&gt;ارزش معاملات %{y:,.2f} هزار میلیون ریال&lt;/b&gt;&lt;br&gt;&lt;extra&gt;&lt;/extra&gt;'\n    ),\n    secondary_y=False,\n    row=2, col=1\n)\n\nfig.add_trace(\n    go.Scatter(\n        name=\"شاخص کل\",\n        x=stock.index[\"jdate\"].jalali.parse_jalali(\"%Y%m%d\"),\n        y=stock.index[\"index\"],\n        line_color='black',\n        mode=\"lines\",\n        marker_size=2,\n        hovertemplate='&lt;b&gt;مقدار %{y:,.2f} هزار واحد&lt;/b&gt;&lt;br&gt;&lt;extra&gt;&lt;/extra&gt;'\n    ),\n    secondary_y=True,\n    row=1, col=1\n)\n\nfig.add_trace(\n    go.Scatter(\n        name=\"ارزش بازار فولاد\",\n        x=stock.index[\"jdate\"].jalali.parse_jalali(\"%Y%m%d\"),\n        y=stock.index[\"market\"]/1e7,\n        line_color='orange',\n        mode=\"lines\",\n        marker_size=2,\n        hovertemplate='&lt;b&gt;ارزش بازار %{y:,.2f} هزار میلیون ریال&lt;/b&gt;&lt;br&gt;&lt;extra&gt;&lt;/extra&gt;'\n    ),\n    secondary_y=False,\n    row=1, col=1\n)\n\nfig.update_layout(\n    font=dict(\n        family=\"Vazirmatn\",\n        size=12,\n        color=\"black\"\n    ),\n    xaxis=dict(\n        title=\"تاریخ\",\n        tickformat='%Y-%m-%d',\n        # rangeslider_visible=True,\n        # rangeslider_thickness=0.04\n    ),\n    yaxis=dict(\n        title=\"ارزش بازار (هزار میلیون تومان)\",\n        # range=[0, 1000],\n        # type='log'\n    ),\n    yaxis2=dict(\n        title=\"شاخص کل (واحد)\",\n        # range=[0, 3000]\n    ),\n    hoverlabel=dict(align=\"right\"),\n    legend=dict(\n        x=.1,\n        y=.9,\n        traceorder=\"normal\",\n        font=dict(\n            family=\"Vazirmatn\",\n            size=12,\n            color=\"black\"\n        ),\n    )\n)\n\nfig.show()",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>بورس تهران</span>"
    ]
  },
  {
    "objectID": "other.html",
    "href": "other.html",
    "title": "دیگر سایت‌ها",
    "section": "",
    "text": "نکته. اگر از محیط ژوپیتر استفاده می‌کنید این کد را اجرا کنید.\n\nimport nest_asyncio\nnest_asyncio.apply()\n\n\nذخیره داده‌های کامودیتی\n\nfrom codal_tsetmc import fill_commodities_prices_table\n\nfill_commodities_prices_table()\n\n\nfrom codal_tsetmc import read_table_by_conditions\n\ncomp = read_table_by_conditions(\"commodities_prices\", \"symbol\", \"price_dollar_rl\")\ncomp\n\n‍‍",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>دیگر سایت‌ها</span>"
    ]
  },
  {
    "objectID": "treasury-bill.html",
    "href": "treasury-bill.html",
    "title": "اسناد خزانه (اخزا)",
    "section": "",
    "text": "آماده سازی داده\nابتدا بسته را به آخرین ورژن بروز رسانی می‌کنیم.\n%pip install --upgrade codal_tsetmc\nپکیج های مورد نیاز را در محیط فراخوانی می‌کنیم.\nimport pandas as pd\nimport numpy as np\nimport jalali_pandas\n\nimport codal_tsetmc as ct\nداده‌های مورد نیاز برای محاسبه سود سالانه هر اوراق را در دیتابیس بروز می‌کنیم. که کمی زمان بر است.\nct.fill_stocks_table()\nct.fill_stocks_prices_table()\nاطلاعات هر اوراق اخزا را از دیتابیس گرفته و در متغیر ذخیره میکنیم.\ndf_info = ct.read_table_by_sql_query(\n    \"\"\"\n    SELECT symbol, code, capital, name\n    FROM stocks\n    WHERE group_type IN ('I1', 'I2', 'I3', 'I4')\n    \"\"\"\n)\n\ndf_info.head()\n\n\n\n\n\n\n\n\n\nsymbol\ncode\ncapital\nname\n\n\n\n\n0\nاخزا706\n71772000724177515\n27788137\nاسنادخزانه-م6بودجه97-990423\n\n\n1\nاخزا4\n71601274953984874\n10000000\nاسناد خزانه اسلامي950821\n\n\n2\nاخزا906\n17166179154270422\n15000000\nاسنادخزانه-م6بودجه99-020321\n\n\n3\nاخزا8\n20807724049262494\n15000000\nاسناد خزانه اسلامي960523\n\n\n4\nسخاب2\n55500157187630757\n16304000\nاسناد خزانه اسلامي960822\nقیمت هر اوراق را نیز از دیتابیس گرفته و در متغیر ذخیره میکنیم.\ncodes = \",\".join(f\"'{code}'\" for code in df_info.code)\n\ndf_price = ct.read_table_by_sql_query(\n    f\"\"\"\n    SELECT code, symbol, date, volume, value, price\n    FROM stocks_prices\n    WHERE code IN ({codes})\n    \"\"\"\n)\n\ndf_price.head()\n\n\n\n\n\n\n\n\n\ncode\nsymbol\ndate\nvolume\nvalue\nprice\n\n\n\n\n0\n10051281467803178\nاخزا711\n13970620000000\n12520\n10266400000\n820000.0\n\n\n1\n10051281467803178\nاخزا711\n13970621000000\n130020\n105186250000\n809001.0\n\n\n2\n10051281467803178\nاخزا711\n13970624000000\n20\n16188078\n809404.0\n\n\n3\n10051281467803178\nاخزا711\n13970625000000\n100000\n81150000000\n811500.0\n\n\n4\n10051281467803178\nاخزا711\n13970626000000\n20000\n16230000000\n811500.0\nدو داده را باهم ادغام میکنیم.\ndf = pd.merge(df_info, df_price, on=[\"symbol\", \"code\"])\ndf.head()\n\n\n\n\n\n\n\n\n\nsymbol\ncode\ncapital\nname\ndate\nvolume\nvalue\nprice\n\n\n\n\n0\nاخزا706\n71772000724177515\n27788137\nاسنادخزانه-م6بودجه97-990423\n13970710000000\n92761\n58629362000\n632048.0\n\n\n1\nاخزا706\n71772000724177515\n27788137\nاسنادخزانه-م6بودجه97-990423\n13970711000000\n9581\n6083935000\n635000.0\n\n\n2\nاخزا706\n71772000724177515\n27788137\nاسنادخزانه-م6بودجه97-990423\n13970714000000\n11021\n6987688093\n634034.0\n\n\n3\nاخزا706\n71772000724177515\n27788137\nاسنادخزانه-م6بودجه97-990423\n13970715000000\n13415\n8534187500\n636168.0\n\n\n4\nاخزا706\n71772000724177515\n27788137\nاسنادخزانه-م6بودجه97-990423\n13970716000000\n150\n97200000\n648000.0\nستون‌های مورد نیاز برای محاسبه سود مرکب سالانه را می‌سازیم.\ndf[\"date\"] = df[\"date\"].str.removesuffix(\"000000\")\ndf[\"due_date\"] = [(\"14\" if due_date &lt; '900000' else \"13\")+due_date for due_date in df.name.str.extract(r'(\\d{6})$')[0]]\n\ndf[\"jdate\"] = df[\"date\"].jalali.parse_jalali(\"%Y%m%d\")\ndf[\"days\"] = ((df[\"due_date\"].jalali.parse_jalali(\"%Y%m%d\") - df.jdate)/np.timedelta64(1, 'D')).astype(int)\n\n\ndf[[\"date\", \"jdate\", \"due_date\", \"days\", \"price\"]].head()\n\n\n\n\n\n\n\n\n\ndate\njdate\ndue_date\ndays\nprice\n\n\n\n\n0\n13970710\n1397-07-10 00:00:00\n13990423\n650\n632048.0\n\n\n1\n13970711\n1397-07-11 00:00:00\n13990423\n649\n635000.0\n\n\n2\n13970714\n1397-07-14 00:00:00\n13990423\n646\n634034.0\n\n\n3\n13970715\n1397-07-15 00:00:00\n13990423\n645\n636168.0\n\n\n4\n13970716\n1397-07-16 00:00:00\n13990423\n644\n648000.0\nفرمول محاسبه سود مرکب سالانه: \\(YTM=(\\cfrac{1,000,000}{Price})^{\\cfrac{365}{days}}-1\\)\ndf[\"ytm\"] = ((1000000/df.price)**(365/df.days)-1)\ndf[[\"jdate\", \"days\", \"ytm\"]].sort_values(\"ytm\", ascending=False).head()\n\n\n\n\n\n\n\n\n\njdate\ndays\nytm\n\n\n\n\n18792\n1399-04-18 00:00:00\n5\n1.691812\n\n\n4742\n1400-05-16 00:00:00\n3\n1.344538\n\n\n14838\n1402-05-25 00:00:00\n12\n1.043377\n\n\n11925\n1397-06-31 00:00:00\n10\n0.920059\n\n\n16271\n1402-08-30 00:00:00\n6\n0.725785\nبرای اینکه سودهای کذایی که به دلیل نزدیکی اوراق‌ها به سررسید ایجاد می‌شود را حذف کنیم از کد زیر استفاده میکنیم.\ndf = df[df.days &gt; 15]\ndf[[\"jdate\", \"days\", \"ytm\"]].sort_values(\"ytm\", ascending=False).head()\n\n\n\n\n\n\n\n\n\njdate\ndays\nytm\n\n\n\n\n6946\n1399-04-18 00:00:00\n26\n0.612420\n\n\n10408\n1399-04-01 00:00:00\n51\n0.558181\n\n\n22723\n1400-08-22 00:00:00\n31\n0.543943\n\n\n969\n1402-02-23 00:00:00\n29\n0.525546\n\n\n31574\n1402-09-19 00:00:00\n36\n0.452534\nمی‌توانیم برای درک بهتر داده‌ها از روش‌های آماری استفاده کنیم که ساده ترین‌ آنها محاسبه میانه و تعداد اوراق‌ها در هر روز است.\ndf_ytm = df[[\"jdate\", \"ytm\"]].groupby(\"jdate\").agg([\"median\", \"count\"])[\"ytm\"]\n\ndf_ytm\n\n\n\n\n\n\n\n\n\nmedian\ncount\n\n\njdate\n\n\n\n\n\n\n1394-07-08 00:00:00\n0.260917\n1\n\n\n1394-07-11 00:00:00\n0.267874\n1\n\n\n1394-07-12 00:00:00\n0.258197\n1\n\n\n1394-07-13 00:00:00\n0.256364\n1\n\n\n1394-07-14 00:00:00\n0.257926\n1\n\n\n...\n...\n...\n\n\n1403-03-08 00:00:00\n0.340772\n26\n\n\n1403-03-09 00:00:00\n0.339223\n27\n\n\n1403-03-12 00:00:00\n0.347138\n24\n\n\n1403-03-13 00:00:00\n0.350030\n52\n\n\n1403-03-16 00:00:00\n0.344439\n22\n\n\n\n\n2083 rows × 2 columns\nبرای اینکه تخمینی از ارزش معاملات داشته باشیم از مجموع ارزش معاملات روزانه اوراق استفاده میکنیم. برای اینکه در نمودار بتوانیم نمایش دهیم بر حسب هزار میلیارد ریال بیان می‌کنیم..\ndf_value = df[[\"jdate\", \"value\"]].groupby(\"jdate\").agg(\n    [\"median\", \"sum\", \"mean\"]\n)[\"value\"]\n\ndf_value[\"scale\"] = df_value[\"sum\"] / 1_000_000_000_000\n\ndf_value\n\n\n\n\n\n\n\n\n\nmedian\nsum\nmean\nscale\n\n\njdate\n\n\n\n\n\n\n\n\n1394-07-08 00:00:00\n3.456456e+11\n345645593500\n3.456456e+11\n0.345646\n\n\n1394-07-11 00:00:00\n5.292737e+10\n52927371560\n5.292737e+10\n0.052927\n\n\n1394-07-12 00:00:00\n6.161099e+09\n6161099076\n6.161099e+09\n0.006161\n\n\n1394-07-13 00:00:00\n8.790125e+09\n8790125279\n8.790125e+09\n0.008790\n\n\n1394-07-14 00:00:00\n4.733399e+09\n4733399398\n4.733399e+09\n0.004733\n\n\n...\n...\n...\n...\n...\n\n\n1403-03-08 00:00:00\n4.359337e+10\n3967297803570\n1.525884e+11\n3.967298\n\n\n1403-03-09 00:00:00\n6.005374e+09\n1796449583630\n6.653517e+10\n1.796450\n\n\n1403-03-12 00:00:00\n2.700826e+10\n2100827818530\n8.753449e+10\n2.100828\n\n\n1403-03-13 00:00:00\n3.646505e+11\n646458345055983\n1.243189e+13\n646.458345\n\n\n1403-03-16 00:00:00\n1.245458e+10\n1348158139350\n6.127992e+10\n1.348158\n\n\n\n\n2083 rows × 4 columns",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>اسناد خزانه (اخزا)</span>"
    ]
  },
  {
    "objectID": "treasury-bill.html#آماده-سازی-داده",
    "href": "treasury-bill.html#آماده-سازی-داده",
    "title": "اسناد خزانه (اخزا)",
    "section": "",
    "text": "نکته. اگر از محیط ژوپیتر استفاده می‌کنید این کد را اجرا کنید.\n\nimport nest_asyncio\nnest_asyncio.apply()",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>اسناد خزانه (اخزا)</span>"
    ]
  },
  {
    "objectID": "treasury-bill.html#رسم-نمودار",
    "href": "treasury-bill.html#رسم-نمودار",
    "title": "اسناد خزانه (اخزا)",
    "section": "رسم نمودار",
    "text": "رسم نمودار\nبرای رسم نمودار می‌توان از کد زیر استفاده کرد که توضیح آن از بحث ما خارج است.\n\nimport plotly.express as px \nfrom plotly.subplots import make_subplots\nimport plotly.graph_objects as go\n\nfig = make_subplots(specs=[[{\"secondary_y\": True}]])\n\n\nfig.add_trace(\n    go.Scatter(\n        name=\"ارزش معاملات روزانه\",\n        x=df_value.index, y=df_value[\"scale\"],\n        stackgroup='one', \n        marker_size=1, \n        mode=\"lines\",\n        line_color='blue',\n        hovertemplate='&lt;b&gt;ارزش معاملات (هزار میلیارد ریال)&lt;/b&gt;: %{y:,.2f}&lt;br&gt;&lt;extra&gt;&lt;/extra&gt;'\n    ),\n    secondary_y=True\n)\n\nfig.add_trace(\n    go.Scatter(\n        name=\"بازده سالانه (YTM)\",\n        x=df[\"jdate\"], y=df[\"ytm\"]*100,\n        mode='markers',\n        marker_color='orange', \n        marker_size=3, \n        customdata=np.stack((\n                df[\"symbol\"],\n                df[\"date\"], df[\"due_date\"],\n                df[\"days\"], df[\"price\"]\n            ),\n            axis=-1\n        ),\n        hovertemplate=(\"&lt;br&gt;\".join(\n            [\n                s.replace(\" \", \" \")\n                for s in [\n                    '&lt;b&gt;نماد اوراق&lt;/b&gt;: %{customdata[0]}',\n                    '&lt;b&gt;تاریخ روز&lt;/b&gt;: %{customdata[1]}',\n                    '&lt;b&gt;سر رسید&lt;/b&gt;: %{customdata[2]}',\n                    '&lt;b&gt;روز باقیمانده&lt;/b&gt;: %{customdata[3]}',\n                    '&lt;b&gt;بازده (درصد)&lt;/b&gt;: %{y:,.2f}',\n                    '&lt;extra&gt;&lt;/extra&gt;'\n                ]\n            ]\n        ))\n    ),\n    secondary_y=False\n)\n\nfig.add_trace(\n    go.Scatter(\n        name=\"میانه کل اوراق‌ها\",\n        x=df_ytm.index, y=df_ytm[\"median\"]*100,\n        line_color='black',\n        mode='markers',\n        marker_size=6, \n        hovertemplate='&lt;b&gt;میانه بازده (درصد)&lt;/b&gt;: %{y:,.2f}&lt;br&gt;&lt;extra&gt;&lt;/extra&gt;'\n    ),\n    secondary_y=False\n)\n\n\nfig.update_layout(\n    font=dict(\n        family=\"Vazirmatn\",\n        size=12,\n        color=\"black\"\n    ),\n    xaxis=dict(\n        title=\"تاریخ\",\n        tickformat='%Y-%m-%d'\n    ),\n    yaxis=dict(\n        title=\"\"\"\n        &lt;br&gt;\n        بازده مرکب سالانه یا همان (درصد)\n        &lt;br&gt;\n        \"\"\",\n        range=[0, 50]\n    ),\n    yaxis2=dict(\n        title=\"\"\"\n        &lt;br&gt;\n        مجموع ارزش معاملات (هزار میلیارد ریال)\n        &lt;br&gt;\n        نمایش لوگاریتمی\n        \"\"\",\n        range=[0, 10],\n        type=\"log\"\n    ),\n    hoverlabel=dict(align=\"right\"),\n    legend=dict(\n        x=.1,\n        y=.9,\n        traceorder=\"normal\",\n        font=dict(\n            family=\"Vazirmatn\",\n            size=12,\n            color=\"black\"\n        ),\n    )\n)\n\nfig.show()",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>اسناد خزانه (اخزا)</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "منابع",
    "section": "",
    "text": "[1] محسن ابراهیمی, https://mohsenebrahimy.ir\n\n\n[2] محسن ابراهیمی, “صفحه نصب بسته کدال و بورس\nتهران در پایتون.” https://pypi.org/project/codal-tsetmc/\n\n\n[3] محسن ابراهیمی, “صفحه گیت‌هاب بسته کدال و\nبورس تهران در پایتون.” https://github.com/mohsenebrahimyir/codal-tsetmc/\n\n\n[4] محسن ابراهیمی, “صفحه راهنمای بسته کدال و\nبورس تهران در پایتون.” https://mohsenebrahimyir.github.io/codal-tsetmc/\n\n\n[5] کدال, “سامانه جامع اطلاع رسانی\nناشران.” https://codal.ir/\n\n\n[6] بورس تهران, “شرکت مدیریت فناوری بورس\nتهران.” http://tsetmc.com/",
    "crumbs": [
      "منابع"
    ]
  }
]